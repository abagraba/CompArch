room labenter{
	println("As you walk down the path, the darkness begins to close in.")
	println("Eerie sounds groan from the depths of the woods.")
	println()
	continue()
	
	println("Suddenly you are blinded by a brilliant bright light.")
	println("As the spots fade from your vision, you see the steel gray walls of a facility of some sort.")
	println("You must have triggered the proximity sensors of the lights.")
	println()
	checkpoint(labentera)
	option(1, "Enter the facility...")
	option(2, "Examine the door...")
	input(1)
	switchr{
		['1']
			goto(lab)
		['2']
			println("The door is wide open. It appears to have rusted brown gashes cut deep in the door and the surrounding frame.")
			println()
			goto(labentera)
	}
}

room lab{
	println("The lab is a wreck.")
	println("You pass upended tables, singed furniture, and even a broken coffee pot... Those heathens.")
	println()
	continue()
	println("This place has clearly not been inhabited in a long, long time.")
	println("Foliage from the forest has made its way deep into the laboratory.")
	println()

	checkpoint(labPlant)
	option(1, "Continue onwards...")
	option(2, "Examine the plant...")
	input(2)
	switchr{
		['1']
			println("You continue down the hallway.")
			println()
		['2']
			println("The leaves seem to sway in the windless corridor. It is almost as if they are alive.")
			continue()
			println("You reach down and try to pluck a leaf.")
			println("The vine begins shaking wildly. You hear a loud screeching coming from where you came.")
			println("Perhaps it would be better off not touching it yet.")
			println()
	}
	
	println("You reach the end of the long hallway. Ahead of you a pair of signs point down two hallways.")
	println("The one pointing to the right says maintenance.")
	println("The one pointing to the left says experiment laboratories.")
	println()
		
	checkpoint(labhall)
	
	option(1, "Go to maintenance...")
	option(2, "Go to experiment laboratories...")
	input(2)
	
	switch{
		['1']
			goto(powerout)
		['2']
			goto(powerout)
	}
	
	println("You stand there unsure of what to do...")
	println()
	goto(labhall)
	
	checkpoint(powerout)	
	println("Suddenly, the lights flicker. The facility shakes as you hear a loud grinding sound.")
	println("The lights go dark...")
	println()
	continue()

	println("You sit there in silence for a brief moment.")
	println("Suddenly a strip of green lighting lightens up to the right.")
	println("'Emergency power activated!', blares out from multiple speakers along the hall.")
	println("'Please follow the emergency lighting strips to maintenance to address the issue.'")
	println()

	checkpoint(labfollow)
	
	option(1, "Follow the lights...")
	option(2, "Go back the way you came...")
	input(2)
	
	switch{
		['1']
			goto(maintenance)
		['2']
			println("It seems that a powered blast door closed behind you during the incident.")
			println("You are not going to get back out this way without power.")
			println()
			goto(labfollow)
	}
}

room maintenance{
	println("You follow the lights down a shady set of stairs. They creak ominously.")
	println("The basement seems to be much worse off than the rest of the laboratory.")
	println("Stagnant water rises up to your knees and the putrid smell of decaying plant matter is almost overwhelming.")
	println()
	continue()
	
	println("Your foot gets caught on something and you trip.")
	println("You splash into the nauseating water.")
	println("You make it back up and attempt to resist the urge to vomit.")
	println("Your efforts were futile...")
	println()
	println("You reach into the water trying to figure out what tripped you.")
	println()
	println("!!! Rusty old pipe get !!!")
	set(rpipe)
	println()
	continue()
	
	goto(basement)
}

room basement{
	if (xbase){
		println("You return to the branched hallways.")
		println()
	}
	else{
		println("You see two paths. The sign says that they lead to the generator room and vehicle maintenance.")
		println()
		set(xbase)
	}

	if (power){
		option(1, "Go back upstairs...")
		input(1)
	}
	else{
		option(1, "Go to vehicle maintenance...")
		option(2, "Go to the generator room...")
		input(2)
	}
	switch{
		['1']
			if (power)
				goto(upstairs)
			goto(vehicle)
		['2']
			goto(generatorroom)
	}

}

room upstairs{
	println("NOOOOOOOOOOOOOOOOO")
}

room vehicle{
	if (gas){
		println("you definitely do not want to go back in there with that thing again...")
		goto(basement)
	}
	else{
		println("You enter the darkened garage.")
		println("Dark silhouettes of ominous vehicles you have never seen before loom over you.")
		println("Suddenly, you hear a clattering in the darkness.")
		println("You freeze.")
		goto(vehicle11)
	}
}
room vehicle11{
	println("You hear an ominous panting in front of you.")
	println()
	
	option(d, "Sneak right...")
	option(w, "Sneak forward...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['d'] 
			println("You sneak to the right...")
			goto(vehicle12)
		['w'] 
			println("You sneak forward...")
			goto(grue)
		['s'] 
			println("You sneak back...")
			goto(basement)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
	
}

room vehicle12{
	println("You hear an ominous panting to your left.")
	println()
	
	option(a, "Sneak left...")
	option(d, "Sneak right...")
	option(w, "Sneak forward...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['a'] 
			println("You sneak to the left...")
			goto(grue)
		['d'] 
			println("You sneak to the right...")
			goto(vehicle13)
		['w'] 
			println("You sneak forward...")
			goto(vehicle22)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}

}
room vehicle13{	
	println("You hear an ominous panting in front of you.")
	println()
	
	option(a, "Sneak left...")
	option(w, "Sneak forward...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['a'] 
			println("You sneak to the left...")
			goto(vehicle12)
		['w'] 
			println("You sneak forward...")
			goto(grue)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}

room vehicle21{	
	println("You hear an ominous panting to your right.")
	println()
	
	option(d, "Sneak right...")
	option(w, "Sneak forward...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['d'] 
			println("You sneak to the right...")
			goto(grue)
		['w'] 
			println("You sneak forward...")
			goto(vehicle31)
		['s'] 
			println("You sneak back...")
			goto(vehicle11)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}
room vehicle22{
	println("You hear an ominous panting to your right.")
	println()
	
	option(a, "Sneak left...")
	option(d, "Sneak right...")
	option(w, "Sneak forward...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['a'] 
			println("You sneak to the left...")
			goto(vehicle21)
		['d'] 
			println("You sneak to the right...")
			goto(grue)
		['w'] 
			println("You sneak forward...")
			goto(vehicle32)
		['s'] 
			println("You sneak back...")
			goto(vehicle12)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}
room vehicle23{
	println("You hear an ominous panting behind you.")
	println()
	
	option(a, "Sneak left...")
	option(w, "Sneak forward...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['a'] 
			println("You sneak to the left...")
			goto(vehicle22)
		['w'] 
			println("You sneak forward...")
			goto(vehicle33)
		['s'] 
			println("You sneak back...")
			goto(grue)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}
room vehicle31{
	println("You hear an ominous panting to your right.")
	println()
	
	option(d, "Sneak right...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['d'] 
			println("You sneak to the right...")
			goto(grue)
		['s'] 
			println("You sneak back...")
			goto(vehicle21)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}
room vehicle32{
	println("You hear an ominous panting behind you.")
	println()
	
	option(a, "Sneak left...")
	option(d, "Sneak right...")
	option(s, "Sneak back...")
	option(r, "Run for your life...")
	
	input(0)
	
	switch{
		['a'] 
			println("You sneak to the left...")
			goto(vehicle31)
		['d'] 
			println("You sneak to the right...")
			goto(vehicle33)
		['s'] 
			println("You sneak back...")
			goto(grue)
		['r'] 
			println("You try to run...")
			println("A terrifying screech comes from behind you.")
			println("You feel a searing pain in your leg as you fall to the floor.")
			goto(grue)
	}
}
room vehicle33{
	println("You find a can of gasoline!")
	println()
	println("!!! Gasoline Get !!!")
	println()
	println("You leave quickly before the mysterious thing gets you.")
	set(gas)
	goto(basement)
}


room generatorroom{
	if (xgeneratorroom){
	}
	else{
		set(xgeneratorroom)
		println("You enter what appears to be the main generator room")
	}
	
	println("There is a large generator in the center of the room")
	
	if (xpump)
		println("There is also a small drainage pump.")
	else
		println("There also seem to be other machines around.")
	
	checkpoint(gen)
	
	if (xgen){
		option(1, "Activate the Generator...")
		input(1)
	}
	else{
		option(1, "Examine the Generator...")
		if (xpump)
			option(2, "Activate the pump...")
		else
			option(2, "Examine the other machines...")
		option(3, "Go back the way you came...")
		input(3)
	}
	
	switch{
		['1']
			if (xgen){
				println("The large generator lets out a grinding squeal that can be heard for miles. It slowly starts screeching its way to a start.")
				println("The lights flicker back on.")
				println("The speakers announce loudly, 'Power has been restored. Please proceed with your research activities.'")
				set(power)
				goto(goodgenroom)
			}
			else{
					println("The large generator is flooded. No way you can get it started without getting rid of the water.")
					println()
					goto(gen)					
			}
		['2']
			if (xpump){
				if (gas){
					println("You fill the pump with gas.")
					println("You pull the starter cord. The pump wheezes lightly. It slowly whirrs to life.")
					println("You feel the water around your knees slowly sink away.")
					println()
					set(xgen)
					goto(gen)
				}
				else
					println("You pull the starter cord. The pump wheezes lightly. It appears to be out of fuel.")
					println()
					goto(gen)
			}
			else{
				println("The machine appears to be a large pump.")
				println()
				set(xpump)
				goto(gen)
			}
		['3']
			goto(basement)
	}
}

room goodgenroom{
	println("Your job acheived, you decide to head back.")
	goto(basement)
}

